{% extends 'base.html' %}
{% load i18n %}
{% block navbar_secundaria %}
    {% if not diario %}
    {% include 'includes/navbarmascotas.html' %}
    {% else %}
    {% include 'includes/navbarbarmascdiarios.html' %}
    {% endif %}
{% endblock navbar_secundaria %}
{% load static %}




{% block title %}Detalle diario{% endblock title %}

{% block content %}

<br>
{% language 'es' %}
<div class="container-fluid">
  <div class="row justify-content-center"> 
    <form id="formAtras" method="GET"  >
      <button type="submit" class="btn btn-success">&laquo;</button>
      <input type="hidden" name="ir" value="atras">  
    </form>
      <div class="col-auto">
          <p class="h2" style="background-color: #D8DFEE ">
            Diario del dia {{ diario.fecha }} 
          </p>
      </div>
        <form id="formSiguiente" method="GET" >
          <button type="submit" class="btn btn-success">&raquo;</button>
          <input type="hidden" name="ir" value="adelante">    
        </form>
  </div>
</div>
{% endlanguage %}


{% if messages %}
  {% for message in messages  %}

    {% if message.level == DEFAULT_MESSAGE_LEVELS.SUCCESS %}
      <br>
      <div class="alert alert-success alert-dismissible fade show" role="alert">
          <strong>
              
              {{ message }} <br>
              
          </strong>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
    {% endif %}

    {% if message.level == DEFAULT_MESSAGE_LEVELS.WARNING %} 
      <br>
      <div class="alert alert-warning alert-dismissible fade show" role="alert">
          <strong>
              
              {{ message }} <br>
              
          </strong>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
    {% endif %}


  {% endfor %}
{% endif %}

<br>
<table class="table table-borderless">
  <thead >
    <tr class="table " style="background-color: #f7e4f7 " >
      <th class="text-center" style="width:40%" >Comida</th>
      <th class="text-center" style="width:30%">Calorias</th>
      <th class="text-center" style="width:15%"> </th>
      <th class="text-center" style="width:15%"></th>
    </tr>
  </thead>
  <tbody>
    {% for i in comidas  %}
    <tr class="table" style="background-color: #D8DFEE ">

      <td align="center">{{ i.alimento.marca }}, {{ i.alimento.nombre }}, {% widthratio i.cantidad 1 i.porcion %}  gramos<td>



      <td align="center">{{ i.total_cal }}</td>

      <td align="center">
        <a href="{% url 'diario_urls:editalimento' i.id %}">
        <img src="{% static 'iconos/modificar.svg' %}" width="22" height="22">
        </a>
      </td>

      <td align="center">
        <a href="{% url 'diario_urls:eliminaralimento' i.id %}">
        <img src="{% static 'iconos/eliminar.svg' %}" width="22" height="22">
        </a>
      </td>

    </tr>

    {% endfor %}
  </tbody>
</table>
<a class="btn btn-success" href="{% url 'alimentos_urls:listar-alimentos' diario.id %}">Agregar comida</a>

<div class="container-fluid">
    <div class="row justify-content-center"> 
      <div class="col-auto">
        <table class="table">
          <thead >
            <tr class="table table-borderless">
              <th scope="col">Calorias</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody>
            <tr class="table-secondary">
              <td>Total</td>
              <td id="tdtotalcal">{{ diario.total_cal }}</td>
            </tr>
            <tr class="table-secondary">
              <td>Meta</td>
              <td id="tdmeta">{{ mascota.meta }} </td>
            </tr>
            <tr class="table-secondary">
              <td>Restantes</td>
              <td id="tdresto"></td>
            </tr>
          </tbody>
        </table>
      </div>
  </div>
</div>

<br>

<div class="container-fluid">
  <div class="row justify-content-center"> 
    <div class="col-auto">
      <form method="post">
        {% csrf_token %}

        {% if diario.completado %}
          <button class="btn-sm btn-success" type="submit">Modificar diario</button>
          <input type="hidden" name="completar" id="completar" value="modificar">
        {% else %}
          <button class="btn-sm btn-success" type="submit">Completar diario</button>
          <input type="hidden" name="completar" id="completar" value="completar">
          <input type="hidden" name="difcal" id="difcal" value="1">
        {% endif %}

      </form>
    </div>
  </div>
</div>



{% block scripts %}
<script type="text/javascript">
window.onload = function difCalorias() {
                  let y = document.getElementById ( "tdtotalcal" ).innerText;
                  let z = document.getElementById ( "tdmeta" ).innerText;
                  let x = Number(z) - Number(y);
                  document.getElementById("tdresto").innerText=x;
                  
                }
</script>

{% endblock scripts %}



{% endblock content %}